
{% extends "base.html" %}

{% block title %}Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ùˆ Ù¾Ø±Ø¯Ø§Ø²Ø´ ÙˆÛŒØ¯Ø¦Ùˆ - GeoSphereAI{% endblock %}

{% block content %}
<div class="container">
    <h2>Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ùˆ Ù¾Ø±Ø¯Ø§Ø²Ø´ ÙˆÛŒØ¯Ø¦Ùˆ</h2>
    <p>ÙØ§ÛŒÙ„ ÙˆÛŒØ¯ÛŒÙˆÛŒÛŒ Ùˆ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø±Ø§ Ù…Ø´Ø®Øµ Ú©Ù†ÛŒØ¯.</p>
    
    <form action="/video-upload" method="post" enctype="multipart/form-data">
        <!-- Ø¨Ø®Ø´ Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ -->
        <div class="upload-area">
            <input type="file" name="video" id="video" accept="video/*" required class="file-input">
            <label for="video" class="file-label">
                <div class="upload-icon">ğŸ“¹</div>
                <div class="upload-text">
                    <strong>Ø§Ù†ØªØ®Ø§Ø¨ ÙØ§ÛŒÙ„ ÙˆÛŒØ¯ÛŒÙˆ</strong>
                    <span>ÛŒØ§ ÙØ§ÛŒÙ„ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø±Ù‡Ø§ Ú©Ù†ÛŒØ¯</span>
                </div>
            </label>
        </div>

        <div class="settings-container">
            <h3>ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø²Ù…Ø§Ù†ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´</h3>
            
            <div class="input-row">
                <div class="input-group">
                    <label for="start_time">Ø²Ù…Ø§Ù† Ø´Ø±ÙˆØ¹</label>
                    <div class="input-with-icon">
                        <span class="input-icon">â±ï¸</span>
                        <input type="number" name="start_time" id="start_time" value="0" min="0" step="0.1">
                        <span class="input-unit">Ø«Ø§Ù†ÛŒÙ‡</span>
                    </div>
                </div>

                <div class="input-group">
                    <label for="end_time">Ø²Ù…Ø§Ù† Ù¾Ø§ÛŒØ§Ù†</label>
                    <div class="input-with-icon">
                        <span class="input-icon">â±ï¸</span>
                        <input type="number" name="end_time" id="end_time" value="10" min="0" step="0.1">
                        <span class="input-unit">Ø«Ø§Ù†ÛŒÙ‡</span>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <label for="frame_interval">ÙØ§ØµÙ„Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ø¨ÛŒÙ† ÙØ±ÛŒÙ…â€ŒÙ‡Ø§</label>
                <div class="range-container">
                    <div class="range-display">
                        <span class="range-current-value" id="frame-interval-display">0.5 Ø«Ø§Ù†ÛŒÙ‡</span>
                    </div>
                    <div class="range-wrapper">
                        <div class="range-labels-top">
                            <span>0.1</span>
                            <span>1</span>
                            <span>2</span>
                            <span>3</span>
                            <span>4</span>
                            <span>5</span>
                            <span>6</span>
                            <span>7</span>
                            <span>8</span>
                            <span>9</span>
                            <span>10</span>
                        </div>
                        <input type="range" name="frame_interval" id="frame_interval" min="0.1" max="10" step="0.1" value="0.5" class="modern-range" oninput="updateFrameInterval(this.value)">
                        <div class="range-step-marks">
                            <span></span><span></span><span></span><span></span><span></span>
                            <span></span><span></span><span></span><span></span><span></span>
                        </div>
                    </div>
                </div>
            </div>

            <h3>ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h3>
            
            <div class="toggle-group">
                <label class="toggle-label" for="classify_images">
                    <span class="toggle-content">
                        <span class="toggle-text">Ø§Ù†Ø¬Ø§Ù… Ø·Ø¨Ù‚Ù‡â€ŒØ¨Ù†Ø¯ÛŒ ØªØµÙˆÛŒØ± (Segformer)</span>
                        <span class="toggle-description">Ø¨Ø±Ø§ÛŒ ØªØ´Ø®ÛŒØµ Ùˆ Ø¬Ø¯Ø§Ø³Ø§Ø²ÛŒ Ø§Ø¬Ø²Ø§ÛŒ Ù…Ø®ØªÙ„Ù ØªØµÙˆÛŒØ±</span>
                    </span>
                    <input type="checkbox" class="toggle-input" id="classify_images" name="classify_images">
                    <span class="toggle-switch"></span>
                </label>
            </div>

            <div class="input-group">
                <label for="crop_height_ratio">Ø¯Ø±ØµØ¯ Ø¨Ø±Ø´ Ø§Ø±ØªÙØ§Ø¹</label>
                <div class="range-container">
                    <div class="range-display">
                        <span class="range-current-value" id="crop-ratio-display">0%</span>
                    </div>
                    <div class="range-wrapper">
                        <div class="range-labels-top">
                            <span>0%</span>
                            <span>10%</span>
                            <span>20%</span>
                            <span>30%</span>
                            <span>40%</span>
                            <span>50%</span>
                            <span>60%</span>
                            <span>70%</span>
                            <span>80%</span>
                            <span>90%</span>
                            <span>100%</span>
                        </div>
                        <input type="range" name="crop_height_ratio" id="crop_height_ratio" min="0" max="1" step="0.1" value="0" class="modern-range" oninput="updateCropRatio(this.value)">
                        <div class="range-step-marks">
                            <span></span><span></span><span></span><span></span><span></span>
                            <span></span><span></span><span></span><span></span><span></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <label for="model_format">Ù‚Ø§Ù„Ø¨ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø®Ø±ÙˆØ¬ÛŒ</label>
                <div class="select-container">
                    <select name="model_format" id="model_format" class="modern-select">
                        <option value="obj" selected>OBJ - Wavefront Object</option>
                        <option value="ply">PLY - Polygon File Format</option>
                        <option value="fbx">FBX - Autodesk FBX</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Ø¯Ú©Ù…Ù‡ Ø§Ø±Ø³Ø§Ù„ -->
        <div class="submit-container">
            <button type="submit" class="submit-btn">
                <span class="btn-icon">ğŸš€</span>
                <span class="btn-text">Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ùˆ Ø´Ø±ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø²Ø´</span>
            </button>
        </div>
    </form>
    
    <div class="navigation-links">
        <a href="{{ url_for('file_selection') }}" class="back-link">&larr; Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ ÙØ§ÛŒÙ„</a>
    </div>
</div>

<script>
// Fixed functions - corrected the reverse calculation
function updateFrameInterval(value) {
    document.getElementById('frame-interval-display').textContent = value + ' Ø«Ø§Ù†ÛŒÙ‡';
}

function updateCropRatio(value) {
    const percentage = Math.round(parseFloat(value) * 100);
    document.getElementById('crop-ratio-display').textContent = percentage + '%';
}

// File upload functionality
document.addEventListener('DOMContentLoaded', function() {
    const fileInput = document.getElementById('video');
    const fileLabel = document.querySelector('.file-label');
    
    // Drag and drop events
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        fileLabel.addEventListener(eventName, preventDefaults, false);
    });
    
    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }
    
    ['dragenter', 'dragover'].forEach(eventName => {
        fileLabel.addEventListener(eventName, highlight, false);
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
        fileLabel.addEventListener(eventName, unhighlight, false);
    });
    
    function highlight(e) {
        fileLabel.classList.add('drag-over');
    }
    
    function unhighlight(e) {
        fileLabel.classList.remove('drag-over');
    }
    
    fileLabel.addEventListener('drop', handleDrop, false);
    
    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        fileInput.files = files;
        updateFileName();
    }
    
    fileInput.addEventListener('change', updateFileName);
    
    function updateFileName() {
        const fileName = fileInput.files[0]?.name;
        if (fileName) {
            document.querySelector('.upload-text strong').textContent = fileName;
            document.querySelector('.upload-text span').textContent = 'ÙØ§ÛŒÙ„ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡';
        }
    }
});
</script>
{% endblock %}
